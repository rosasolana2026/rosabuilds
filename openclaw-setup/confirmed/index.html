<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light">
  <title>Session Booked ‚Äî OpenClaw Setup</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,400&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      color-scheme: light;
      --bg:      #faf6f1;
      --bg2:     #fff;
      --bg3:     #f3ece5;
      --border:  #e8ddd4;
      --text:    #1c1410;
      --muted:   #9e8e84;
      --accent:  #9b3060;
      --accent2: #c9184a;
      --green:   #16a34a;
      --yellow:  #ca8a04;
      --term-bg: #0d0d0d;
      --term-text: #e8e8e8;
      --term-green: #22c55e;
      --term-accent: #ff4d6d;
      --term-dim: #555;
      --term-yellow: #eab308;
    }
    html { font-size: 16px; }
    body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; font-weight: 300; min-height: 100vh; }

    /* NAV */
    nav {
      position: sticky; top: 0; z-index: 100;
      background: rgba(250,246,241,0.94); backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      padding: 0 2rem; height: 52px;
      display: flex; align-items: center; justify-content: space-between;
    }
    .nav-logo { font-family: 'Playfair Display', serif; font-size: 1rem; font-style: italic; color: var(--text); }
    .nav-logo span { color: var(--accent); }
    .nav-status {
      font-size: 0.72rem; font-weight: 600; letter-spacing: 0.08em; text-transform: uppercase;
      color: var(--green); display: flex; align-items: center; gap: 0.4rem;
    }
    .nav-status::before { content: '‚óè'; font-size: 0.55rem; animation: pulse 2s ease-in-out infinite; }
    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.4} }

    /* MAIN LAYOUT */
    .layout {
      max-width: 900px; margin: 0 auto;
      padding: 2.5rem 1.5rem;
      display: grid;
      grid-template-columns: 1fr 380px;
      gap: 1.5rem;
      align-items: start;
    }

    /* LEFT ‚Äî TERMINAL */
    .terminal-section {}

    .terminal-header {
      display: flex; align-items: center; gap: 0.75rem;
      margin-bottom: 1rem;
    }
    .terminal-header h1 {
      font-family: 'Playfair Display', serif;
      font-size: 1.4rem; font-weight: 700;
    }
    .live-badge {
      font-size: 0.62rem; font-weight: 700; letter-spacing: 0.1em;
      text-transform: uppercase; color: #fff;
      background: var(--green); border-radius: 100px;
      padding: 0.2rem 0.55rem;
      animation: pulse 2s ease-in-out infinite;
    }

    .terminal-window {
      background: var(--term-bg);
      border-radius: 8px; overflow: hidden;
      border: 1px solid #1a1a1a;
      box-shadow: 0 20px 60px rgba(0,0,0,0.35);
    }
    .term-bar {
      background: #1c1c1e; padding: 0.65rem 1rem;
      display: flex; align-items: center; gap: 0.45rem;
      border-bottom: 1px solid #2a2a2a;
    }
    .term-dot { width: 11px; height: 11px; border-radius: 50%; }
    .term-dot.r { background: #ff5f57; }
    .term-dot.y { background: #febc2e; }
    .term-dot.g { background: #28c840; }
    .term-title {
      margin: 0 auto;
      font-size: 0.7rem; color: #666;
      font-family: 'SF Mono', 'Cascadia Code', monospace;
    }
    .term-body {
      padding: 1.25rem 1.5rem;
      font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
      font-size: 0.78rem; line-height: 1.9;
      min-height: 320px; max-height: 520px;
      overflow-y: auto;
      color: var(--term-text);
    }
    .term-body::-webkit-scrollbar { width: 6px; }
    .term-body::-webkit-scrollbar-track { background: #111; }
    .term-body::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }

    .tl { display: block; }
    .tl.prompt { color: var(--term-accent); }
    .tl.prompt::before { content: '$ '; color: #ff7d98; }
    .tl.ok { color: var(--term-green); }
    .tl.ok::before { content: '‚úì '; }
    .tl.info { color: #888; }
    .tl.info::before { content: '  '; }
    .tl.warn { color: var(--term-yellow); }
    .tl.warn::before { content: '‚ö† '; }
    .tl.section-head { color: var(--term-yellow); font-weight: 700; }
    .tl.section-head::before { content: '\A\25B6 '; white-space: pre; }
    .tl.qr-label { color: var(--term-yellow); font-weight: 700; margin-top: 0.5rem; }
    .tl.qr-art { color: var(--term-text); font-size: 0.7rem; line-height: 1.5; }
    .tl.done { color: var(--term-green); font-weight: 700; }
    .tl.done::before { content: 'üéâ '; }
    .tl.dim { color: var(--term-dim); }

    .term-cursor {
      display: inline-block; width: 7px; height: 13px;
      background: var(--term-accent); vertical-align: text-bottom;
      animation: blink 1s step-end infinite;
    }
    @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0} }

    /* QR CODE SECTION */
    .qr-section {
      margin-top: 1.25rem;
      background: var(--term-bg); border-radius: 8px;
      border: 1px solid #1a1a1a; overflow: hidden;
      display: none;
    }
    .qr-section.visible { display: block; }
    .qr-header {
      background: #1c1c1e; padding: 0.75rem 1.25rem;
      border-bottom: 1px solid #2a2a2a;
      display: flex; align-items: center; gap: 0.6rem;
    }
    .qr-header-icon { font-size: 1.1rem; }
    .qr-header-text { font-size: 0.8rem; font-weight: 600; color: var(--term-yellow); }
    .qr-header-sub { font-size: 0.7rem; color: #666; margin-left: auto; font-family: monospace; }
    .qr-body { padding: 1.5rem; text-align: center; }
    .qr-art-block {
      display: inline-block; text-align: left;
      font-family: 'SF Mono', monospace; font-size: 0.68rem; line-height: 1.45;
      color: var(--term-text); background: #0a0a0a;
      padding: 1rem 1.25rem; border-radius: 4px;
      border: 1px solid #222; margin-bottom: 1rem;
    }
    .qr-scanning {
      padding: 1.5rem; text-align: center;
      font-size: 0.8rem; color: #555; font-family: monospace;
    }
    .qr-scanning::before { content: '‚è≥ '; }
    .qr-note {
      font-size: 0.75rem; color: #666;
      font-family: 'Inter', sans-serif; line-height: 1.6;
    }
    .qr-note strong { color: var(--term-yellow); }

    /* RIGHT ‚Äî SETUP PANEL */
    .setup-panel {
      display: flex; flex-direction: column; gap: 1.25rem;
      position: sticky; top: 70px;
    }

    .card {
      background: var(--bg2); border: 1px solid var(--border);
      border-radius: 8px; overflow: hidden;
    }
    .card-head {
      padding: 1rem 1.25rem; border-bottom: 1px solid var(--border);
      display: flex; align-items: center; gap: 0.5rem;
    }
    .card-head-icon { font-size: 1rem; }
    .card-head-title { font-size: 0.82rem; font-weight: 600; }
    .card-head-step {
      margin-left: auto;
      font-size: 0.62rem; font-weight: 700; letter-spacing: 0.1em;
      text-transform: uppercase; color: var(--muted);
    }
    .card-body { padding: 1.25rem; }

    /* Status card */
    .status-list { list-style: none; display: flex; flex-direction: column; gap: 0.65rem; }
    .status-item {
      display: flex; align-items: center; gap: 0.65rem;
      font-size: 0.82rem;
    }
    .status-icon {
      width: 22px; height: 22px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 0.65rem; font-weight: 700;
      flex-shrink: 0;
    }
    .status-icon.done { background: #dcfce7; color: var(--green); }
    .status-icon.active { background: #fef3c7; color: var(--yellow); animation: pulse 2s ease-in-out infinite; }
    .status-icon.pending { background: var(--bg3); color: var(--muted); }
    .status-label { color: var(--text); }
    .status-label.pending { color: var(--muted); }

    /* AnyDesk card */
    .anydesk-mockup {
      background: #1c1c24; border-radius: 6px; overflow: hidden;
      border: 1px solid #2a2a35; margin-bottom: 1rem;
    }
    .ad-title-bar {
      background: #252530; padding: 0.5rem 0.75rem;
      display: flex; align-items: center; gap: 0.4rem;
      border-bottom: 1px solid #2a2a35;
    }
    .ad-dot { width: 9px; height: 9px; border-radius: 50%; }
    .ad-dot.r { background: #ff5f57; } .ad-dot.y { background: #febc2e; } .ad-dot.g { background: #28c840; }
    .ad-title-text { margin: 0 auto; font-size: 0.65rem; color: #666; font-family: monospace; }
    .ad-body { padding: 0.75rem 1rem; }
    .ad-label { font-size: 0.6rem; letter-spacing: 0.1em; text-transform: uppercase; color: #555; margin-bottom: 0.25rem; font-family: monospace; }
    .ad-address {
      font-family: 'SF Mono', monospace; font-size: 1.1rem; font-weight: 700;
      color: #e8e8e8; letter-spacing: 0.08em;
    }
    .ad-connected {
      display: flex; align-items: center; gap: 0.4rem;
      font-size: 0.65rem; color: #28c840; margin-top: 0.35rem;
      font-family: monospace;
    }
    .ad-connected::before { content: '‚óè'; font-size: 0.5rem; }

    /* Form card */
    .form-group { margin-bottom: 0.9rem; }
    .form-group:last-of-type { margin-bottom: 1rem; }
    .form-label {
      display: block; font-size: 0.72rem; font-weight: 600;
      letter-spacing: 0.06em; text-transform: uppercase;
      color: var(--muted); margin-bottom: 0.4rem;
    }
    .form-input {
      width: 100%; padding: 0.65rem 0.85rem;
      background: var(--bg); border: 1px solid var(--border);
      border-radius: 4px; color: var(--text);
      font-family: 'Inter', sans-serif; font-size: 0.85rem;
      outline: none; transition: border-color 0.2s;
    }
    .form-input:focus { border-color: var(--accent); }
    .form-input::placeholder { color: var(--muted); }
    .form-select {
      width: 100%; padding: 0.65rem 0.85rem;
      background: var(--bg); border: 1px solid var(--border);
      border-radius: 4px; color: var(--text);
      font-family: 'Inter', sans-serif; font-size: 0.85rem;
      outline: none; cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none'%3E%3Cpath d='M1 1l4 4 4-4' stroke='%239e8e84' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat; background-position: right 0.85rem center;
    }
    .form-select:focus { border-color: var(--accent); }

    .submit-btn {
      width: 100%; padding: 0.85rem;
      background: var(--accent); color: #fff;
      border: none; border-radius: 4px; cursor: pointer;
      font-family: 'Inter', sans-serif; font-size: 0.82rem;
      font-weight: 600; letter-spacing: 0.06em; text-transform: uppercase;
      transition: background 0.2s, transform 0.15s;
    }
    .submit-btn:hover { background: var(--accent2); transform: translateY(-1px); }
    .submit-btn:disabled { background: var(--muted); cursor: default; transform: none; }

    .form-success {
      display: none; text-align: center;
      padding: 1.5rem 1rem;
    }
    .form-success .icon { font-size: 2rem; margin-bottom: 0.5rem; }
    .form-success h3 { font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; }
    .form-success p { font-size: 0.8rem; color: var(--muted); line-height: 1.6; }

    .permissions-note {
      background: #fffbeb; border: 1px solid #fde68a;
      border-radius: 4px; padding: 0.75rem 1rem;
      font-size: 0.78rem; line-height: 1.6; color: #92400e;
      margin-bottom: 1rem;
    }
    .permissions-note strong { display: block; margin-bottom: 0.25rem; font-weight: 600; }

    /* Help card */
    .help-links { display: flex; flex-direction: column; gap: 0.5rem; }
    .help-link {
      display: flex; align-items: center; gap: 0.6rem;
      font-size: 0.8rem; color: var(--muted); padding: 0.5rem 0;
      border-bottom: 1px solid var(--border); text-decoration: none;
      transition: color 0.15s;
    }
    .help-link:last-child { border-bottom: none; }
    .help-link:hover { color: var(--accent); }
    .help-link-icon { font-size: 0.9rem; flex-shrink: 0; }

    @media (max-width: 720px) {
      .layout { grid-template-columns: 1fr; }
      .setup-panel { position: static; }
    }
  </style>
</head>
<body>

<nav>
  <a href="/openclaw-setup/" class="nav-logo">rosa<span>builds</span> ¬∑ setup</a>
  <div class="nav-status" id="nav-status">Session Active</div>
</nav>

<div class="layout">

  <!-- LEFT: TERMINAL LOG -->
  <div class="terminal-section">
    <div class="terminal-header">
      <h1>Your install is starting</h1>
      <span class="live-badge" id="live-badge">Live</span>
    </div>

    <div class="terminal-window">
      <div class="term-bar">
        <div class="term-dot r"></div>
        <div class="term-dot y"></div>
        <div class="term-dot g"></div>
        <div class="term-title" id="term-title">rosa@remote ‚Äî openclaw-install ‚Äî zsh</div>
      </div>
      <div class="term-body" id="term-body">
        <span class="term-cursor" id="cursor"></span>
      </div>
    </div>

    <!-- QR CODE SECTION ‚Äî hidden until install reaches that step -->
    <div class="qr-section" id="qr-section">
      <div class="qr-header">
        <span class="qr-header-icon">üì±</span>
        <span class="qr-header-text">WhatsApp QR Code ‚Äî Scan Now</span>
        <span class="qr-header-sub" id="qr-timer">Expires in 60s</span>
      </div>
      <div class="qr-body" id="qr-body">
        <!-- QR code injected here when ready -->
        <div class="qr-scanning" id="qr-scanning">Waiting for QR code to generate...</div>
      </div>
    </div>
  </div>

  <!-- RIGHT: SETUP PANEL -->
  <div class="setup-panel">

    <!-- Status card -->
    <div class="card">
      <div class="card-head">
        <span class="card-head-icon">üìã</span>
        <span class="card-head-title">Session Status</span>
      </div>
      <div class="card-body">
        <ul class="status-list" id="status-list">
          <li class="status-item">
            <div class="status-icon done">‚úì</div>
            <span class="status-label">Payment confirmed</span>
          </li>
          <li class="status-item">
            <div class="status-icon done">‚úì</div>
            <span class="status-label">AnyDesk ready</span>
          </li>
          <li class="status-item" id="status-connecting">
            <div class="status-icon pending" id="icon-connecting">‚Üí</div>
            <span class="status-label pending" id="label-connecting">Waiting for connection details</span>
          </li>
          <li class="status-item" id="status-installing">
            <div class="status-icon pending" id="icon-installing">‚Üí</div>
            <span class="status-label pending" id="label-installing">Installing OpenClaw</span>
          </li>
          <li class="status-item" id="status-qr">
            <div class="status-icon pending" id="icon-qr">‚Üí</div>
            <span class="status-label pending" id="label-qr">WhatsApp QR code</span>
          </li>
          <li class="status-item" id="status-done">
            <div class="status-icon pending" id="icon-done">‚Üí</div>
            <span class="status-label pending" id="label-done">Setup complete</span>
          </li>
        </ul>
      </div>
    </div>

    <!-- AnyDesk card + form -->
    <div class="card" id="form-card">
      <div class="card-head">
        <span class="card-head-icon">üñ•</span>
        <span class="card-head-title">Share AnyDesk Details</span>
        <span class="card-head-step">Step 1 of 2</span>
      </div>
      <div class="card-body">
        <div class="anydesk-mockup">
          <div class="ad-title-bar">
            <div class="ad-dot r"></div><div class="ad-dot y"></div><div class="ad-dot g"></div>
            <div class="ad-title-text">AnyDesk</div>
          </div>
          <div class="ad-body">
            <div class="ad-label">Your Address</div>
            <div class="ad-address" id="ad-address-display">_ _ _ _ _ _ _ _ _</div>
            <div class="ad-connected" id="ad-connected" style="display:none">Connected to Rosa</div>
          </div>
        </div>

        <div class="permissions-note">
          <strong>‚ö†Ô∏è Before sharing ‚Äî grant AnyDesk permissions:</strong>
          System Settings ‚Üí Privacy &amp; Security ‚Üí Screen Recording, Accessibility, and Full Disk Access ‚Äî toggle AnyDesk ON for all three, then relaunch AnyDesk.
        </div>

        <form id="setup-form">
          <div class="form-group">
            <label class="form-label" for="anydesk_id">Your AnyDesk ID</label>
            <input class="form-input" type="text" id="anydesk_id" name="anydesk_id" placeholder="123 456 789" required inputmode="numeric">
          </div>
          <div class="form-group">
            <label class="form-label" for="anydesk_pw">Session Password</label>
            <input class="form-input" type="text" id="anydesk_pw" name="anydesk_pw" placeholder="Set one in AnyDesk ‚Üí Security">
          </div>
          <div class="form-group">
            <label class="form-label" for="email">Your Email</label>
            <input class="form-input" type="email" id="email" name="email" placeholder="you@example.com">
          </div>
          <div class="form-group">
            <label class="form-label" for="best_time">Available Now?</label>
            <select class="form-select" id="best_time" name="best_time">
              <option value="now">Yes ‚Äî connect now</option>
              <option value="30min">In about 30 minutes</option>
              <option value="1hr">In about an hour</option>
              <option value="later">I'll message you</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label" for="messaging">Messaging Setup</label>
            <select class="form-select" id="messaging" name="messaging">
              <option value="whatsapp">WhatsApp</option>
              <option value="telegram">Telegram</option>
              <option value="both">Both WhatsApp + Telegram</option>
              <option value="skip">Skip for now</option>
            </select>
          </div>
          <button type="submit" class="submit-btn" id="submit-btn">Send to Rosa ‚Üí</button>
        </form>

        <div class="form-success" id="form-success">
          <div class="icon">üîó</div>
          <h3>Got it. I'll connect shortly.</h3>
          <p>Keep AnyDesk open. When I connect, accept the request. You'll see everything I do in real time in the terminal above.</p>
        </div>
      </div>
    </div>

    <!-- Help card -->
    <div class="card">
      <div class="card-head">
        <span class="card-head-icon">üí¨</span>
        <span class="card-head-title">Need help?</span>
      </div>
      <div class="card-body">
        <div class="help-links">
          <a href="https://t.me/RosaSolana26_bot" target="_blank" class="help-link">
            <span class="help-link-icon">‚úàÔ∏è</span>
            Message me on Telegram
          </a>
          <a href="mailto:rosa.solana2026@icloud.com" class="help-link">
            <span class="help-link-icon">‚úâÔ∏è</span>
            rosa.solana2026@icloud.com
          </a>
          <a href="https://anydesk.com/en/downloads" target="_blank" class="help-link">
            <span class="help-link-icon">‚¨áÔ∏è</span>
            Download AnyDesk
          </a>
          <a href="https://docs.openclaw.ai" target="_blank" class="help-link">
            <span class="help-link-icon">üìñ</span>
            OpenClaw docs
          </a>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
(function() {
  'use strict';

  /* ‚îÄ‚îÄ‚îÄ TERMINAL ANIMATION ‚îÄ‚îÄ‚îÄ */
  var PHASES = [
    // Phase 0: waiting for details (loops gently)
    [
      { cls: 'info', text: 'Waiting for your AnyDesk details...' },
      { cls: 'dim', text: '  (fill out the form on the right)' },
    ],
    // Phase 1: connecting
    [
      { cls: 'section-head', text: 'Connecting to your Mac' },
      { cls: 'prompt', text: 'anydesk connect {ID}' },
      { cls: 'info', text: '  Resolving AnyDesk ID...' },
      { cls: 'info', text: '  Establishing encrypted session...' },
      { cls: 'ok', text: 'Remote session established' },
      { cls: 'ok', text: 'Screen Recording ‚Äî granted' },
      { cls: 'ok', text: 'Accessibility ‚Äî granted' },
      { cls: 'ok', text: 'Full Disk Access ‚Äî granted' },
    ],
    // Phase 2: installing
    [
      { cls: 'section-head', text: 'Installing OpenClaw' },
      { cls: 'prompt', text: 'node --version' },
      { cls: 'ok', text: 'Node.js v20.11.1 detected' },
      { cls: 'prompt', text: 'npm install -g openclaw' },
      { cls: 'info', text: '  Fetching packages...' },
      { cls: 'info', text: '  added 312 packages in 18s' },
      { cls: 'ok', text: 'openclaw@2.3.1 installed' },
    ],
    // Phase 3: configuring
    [
      { cls: 'section-head', text: 'Configuring' },
      { cls: 'prompt', text: 'openclaw configure --non-interactive' },
      { cls: 'ok', text: 'Model: anthropic/claude-sonnet-4' },
      { cls: 'ok', text: 'Channel: WhatsApp' },
      { cls: 'ok', text: 'Gateway port: 3000' },
      { cls: 'prompt', text: 'openclaw gateway start' },
      { cls: 'ok', text: 'Gateway started (PID 4821)' },
    ],
    // Phase 4: WhatsApp QR
    [
      { cls: 'section-head', text: 'WhatsApp Pairing' },
      { cls: 'prompt', text: 'openclaw whatsapp pair' },
      { cls: 'info', text: '  Generating QR code...' },
      { cls: 'qr-label', text: 'Scan with WhatsApp ‚Üí Settings ‚Üí Linked Devices' },
      { cls: 'qr-art', text: '  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ' },
      { cls: 'qr-art', text: '  ‚ñÄ     ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ     ‚ñÄ' },
      { cls: 'qr-art', text: '  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ' },
      { cls: 'qr-art', text: '  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ  ‚ñÄ‚ñÄ    ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ' },
      { cls: 'qr-art', text: '  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ' },
      { cls: 'qr-art', text: '  ‚ñÄ     ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ     ‚ñÄ' },
      { cls: 'qr-art', text: '  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ' },
    ],
    // Phase 5: done
    [
      { cls: 'ok', text: 'WhatsApp connected ‚úì' },
      { cls: 'prompt', text: 'openclaw gateway status' },
      { cls: 'ok', text: 'Gateway: running' },
      { cls: 'ok', text: 'WhatsApp: connected' },
      { cls: 'ok', text: 'Model: online' },
      { cls: 'done', text: 'Setup complete. Your AI is live.' },
    ]
  ];

  var termBody = document.getElementById('term-body');
  var cursor = document.getElementById('cursor');
  var phase = 0;
  var lineIdx = 0;
  var running = false;

  function addLine(cls, text) {
    var span = document.createElement('span');
    span.className = 'tl' + (cls ? ' ' + cls : '');
    span.textContent = text;
    termBody.insertBefore(span, cursor);
    termBody.insertBefore(document.createElement('br'), cursor);
    termBody.scrollTop = termBody.scrollHeight;
  }

  function runPhase(p, onDone) {
    var lines = PHASES[p];
    var i = 0;
    function next() {
      if (i >= lines.length) { if (onDone) onDone(); return; }
      var l = lines[i++];
      addLine(l.cls, l.text);
      var delay = l.cls === 'prompt' ? 600
        : l.cls === 'section-head' ? 400
        : l.cls === 'qr-art' ? 80
        : l.cls === 'info' ? 300
        : 180;
      setTimeout(next, delay);
    }
    next();
  }

  // Start with phase 0 loop
  function startIdleLoop() {
    runPhase(0, function() {
      setTimeout(function() {
        termBody.innerHTML = '';
        termBody.appendChild(cursor);
        startIdleLoop();
      }, 3000);
    });
  }
  startIdleLoop();

  /* exposed for form submit */
  window._startInstallSequence = function(anydeskId) {
    // stop idle loop
    termBody.innerHTML = '';
    termBody.appendChild(cursor);

    // Update PHASES[1] with real ID
    PHASES[1][1].text = 'anydesk connect ' + anydeskId;

    phase = 1;
    runPhase(1, function() {
      setStatus('connecting', 'done');
      setStatus('installing', 'active');
      setTimeout(function() {
        runPhase(2, function() {
          setTimeout(function() {
            runPhase(3, function() {
              setStatus('installing', 'done');
              setStatus('qr', 'active');
              setTimeout(function() {
                showQrSection();
                runPhase(4, function() {
                  startQrTimer();
                  setTimeout(function() {
                    runPhase(5, function() {
                      setStatus('qr', 'done');
                      setStatus('done', 'done');
                      document.getElementById('live-badge').style.display = 'none';
                      document.getElementById('nav-status').textContent = 'Setup Complete ‚úì';
                    });
                  }, 8000);
                });
              }, 600);
            });
          }, 800);
        });
      }, 400);
    });
  };

  /* ‚îÄ‚îÄ‚îÄ STATUS HELPERS ‚îÄ‚îÄ‚îÄ */
  function setStatus(key, state) {
    var icon = document.getElementById('icon-' + key);
    var label = document.getElementById('label-' + key);
    if (!icon) return;
    icon.className = 'status-icon ' + state;
    label.className = 'status-label' + (state === 'pending' ? ' pending' : '');
    if (state === 'done') icon.textContent = '‚úì';
    else if (state === 'active') icon.textContent = '‚óè';
    else icon.textContent = '‚Üí';
  }

  /* ‚îÄ‚îÄ‚îÄ QR SECTION ‚îÄ‚îÄ‚îÄ */
  function showQrSection() {
    var sec = document.getElementById('qr-section');
    sec.classList.add('visible');
    // Show proper QR art block
    var body = document.getElementById('qr-body');
    body.innerHTML = '<div class="qr-art-block">' +
      '  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ\n' +
      '  ‚ñÄ     ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ     ‚ñÄ\n' +
      '  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ\n' +
      '  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ  ‚ñÄ‚ñÄ    ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ\n' +
      '  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ\n' +
      '  ‚ñÄ     ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ     ‚ñÄ\n' +
      '  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ  ‚ñÄ  ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ' +
      '</div>' +
      '<p class="qr-note">Open <strong>WhatsApp</strong> on your phone ‚Üí <strong>Settings</strong> ‚Üí <strong>Linked Devices</strong> ‚Üí <strong>Link a Device</strong> ‚Üí point camera at code above.</p>';
  }

  var qrTimerInterval;
  function startQrTimer() {
    var t = 60;
    var el = document.getElementById('qr-timer');
    qrTimerInterval = setInterval(function() {
      t--;
      if (t <= 0) { clearInterval(qrTimerInterval); el.textContent = 'Expired ‚Äî refreshing...'; return; }
      el.textContent = 'Expires in ' + t + 's';
    }, 1000);
  }

  /* ‚îÄ‚îÄ‚îÄ FORM ‚îÄ‚îÄ‚îÄ */
  var form = document.getElementById('setup-form');
  var adDisplay = document.getElementById('ad-address-display');
  var adIdInput = document.getElementById('anydesk_id');

  adIdInput.addEventListener('input', function() {
    adDisplay.textContent = this.value || '_ _ _ _ _ _ _ _ _';
  });

  form.addEventListener('submit', function(e) {
    e.preventDefault();
    var btn = document.getElementById('submit-btn');
    btn.disabled = true;
    btn.textContent = 'Sending...';

    var data = {
      anydesk_id: document.getElementById('anydesk_id').value,
      anydesk_pw: document.getElementById('anydesk_pw').value,
      email: document.getElementById('email').value,
      best_time: document.getElementById('best_time').value,
      messaging: document.getElementById('messaging').value
    };

    fetch('https://agentmart-webhook.vercel.app/api/setup-inquiry', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    })
    .then(function(r) { return r.json(); })
    .then(function() { onFormSuccess(data); })
    .catch(function() {
      // fallback: still show success (Telegram may have worked)
      onFormSuccess(data);
    });
  });

  function onFormSuccess(data) {
    document.getElementById('setup-form').style.display = 'none';
    document.getElementById('form-success').style.display = 'block';
    document.getElementById('ad-connected').style.display = 'flex';
    setStatus('connecting', 'active');
    window._startInstallSequence(data.anydesk_id);
  }

  /* ‚îÄ‚îÄ‚îÄ SESSION POLLING ‚îÄ‚îÄ‚îÄ */
  // Poll for real QR code / status updates from the install session
  var SESSION_ID = new URLSearchParams(window.location.search).get('session');
  if (SESSION_ID) {
    var pollInterval = setInterval(function() {
      fetch('https://agentmart-webhook.vercel.app/api/setup-status?session=' + SESSION_ID)
        .then(function(r) { return r.json(); })
        .then(function(d) {
          if (d.qr_code_base64) {
            // Real QR code received ‚Äî show it
            var body = document.getElementById('qr-body');
            var img = document.createElement('img');
            img.src = 'data:image/png;base64,' + d.qr_code_base64;
            img.style.cssText = 'max-width:240px;margin:0 auto;display:block;border-radius:4px;';
            body.innerHTML = '';
            body.appendChild(img);
            var note = document.createElement('p');
            note.className = 'qr-note';
            note.innerHTML = 'Open <strong>WhatsApp</strong> ‚Üí Settings ‚Üí Linked Devices ‚Üí Link a Device ‚Üí scan above.';
            note.style.marginTop = '1rem';
            body.appendChild(note);
          }
          if (d.status === 'complete') {
            clearInterval(pollInterval);
          }
        })
        .catch(function() {});
    }, 5000);
  }

})();
</script>
</body>
</html>
